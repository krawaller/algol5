import fs from "fs-extra";
import path from "path";
import { newsList } from "../../content/dist/newsList";

const out = path.join(__dirname, "../pages/news");
fs.ensureDirSync(out);

for (const data of newsList) {
  const content = `
// Generated by the makeNewsPages command

import React, { Fragment } from "react";

import Head from "next/head";
import { ArticlePage } from "../../../../ui/src/components/ArticlePage";
import { pageActions } from "../../../helpers";
import { news } from "../../../../content/dist/news/${data.id}/news";
import { listing } from "../../../../content/dist/news/${data.id}/listing";

export const Article = () => {
  const title = \`${data.id} - ${data.title}\`;
  return (
    <Fragment>
      <Head>
        <meta property="og:site_name" content="Chessicals"/>
        <meta property="og:image" content="${data.mainImage}" />
        <meta property="og:title" content={title} />
        <meta property="og:description" content="${data.blurb}"/>
        <title>{title}</title>
      </Head>
      <ArticlePage
        category="News"
        title={title}
        actions={pageActions}
        html={news}
      />
    </Fragment>
  );
};

export default Article;
`;
  fs.emptyDirSync(path.join(out, data.slug));
  fs.writeFileSync(path.join(out, data.slug, "index.tsx"), content);
  console.log("Created page for news item", data.id, data.slug);
}
